<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
	</head>
	<body>
		<template>
			<h1 id="competitive-programming-homochromatic-square-frames">
				Competitive Programming: Homochromatic Square Frames
			</h1>
			<p>
				One of my favorite problems, originally heard in a Microsoft interview.
				There, an
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>4</mn></msup
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^4)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">4</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span class="mclose">)</span></span
						></span
					></span
				>
				solution was sufficient.
			</p>
			<blockquote>
				<p>
					Each cell in a
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow><mi>N</mi></mrow
									><annotation encoding="application/x-tex"
										>N</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.68333em; vertical-align: 0em"
								></span
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								></span
							></span
						></span
					>-by-<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow><mi>N</mi></mrow
									><annotation encoding="application/x-tex"
										>N</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.68333em; vertical-align: 0em"
								></span
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								></span
							></span
						></span
					>
					grid
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow><mi>G</mi></mrow
									><annotation encoding="application/x-tex"
										>G</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.68333em; vertical-align: 0em"
								></span
								><span class="mord mathnormal">G</span></span
							></span
						></span
					>
					is colored either black or white:
				</p>
				<p class="katex-block">
					<span class="katex-display"
						><span class="katex"
							><span class="katex-mathml"
								><math
									xmlns="http://www.w3.org/1998/Math/MathML"
									display="block"
									><semantics
										><mrow
											><msub
												><mi>G</mi
												><mrow
													><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
												></msub
											><mo>=</mo
											><mrow
												><mo fence="true">{</mo
												><mtable
													rowspacing="0.3600em"
													columnalign="left left"
													columnspacing="1em"
													><mtr
														><mtd
															><mstyle scriptlevel="0" displaystyle="false"
																><mn>0</mn></mstyle
															></mtd
														><mtd
															><mstyle scriptlevel="0" displaystyle="false"
																><mtext>white</mtext></mstyle
															></mtd
														></mtr
													><mtr
														><mtd
															><mstyle scriptlevel="0" displaystyle="false"
																><mn>1</mn></mstyle
															></mtd
														><mtd
															><mstyle scriptlevel="0" displaystyle="false"
																><mtext>black</mtext></mstyle
															></mtd
														></mtr
													></mtable
												></mrow
											><mi mathvariant="normal">.</mi></mrow
										><annotation encoding="application/x-tex"
											>G_{i,j}=\begin{cases} 0&amp;\text{white}\\
											1&amp;\text{black} \end{cases}.</annotation
										></semantics
									></math
								></span
							><span class="katex-html" aria-hidden="true"
								><span class="base"
									><span
										class="strut"
										style="height: 0.969438em; vertical-align: -0.286108em"
									></span
									><span class="mord"
										><span class="mord mathnormal">G</span
										><span class="msupsub"
											><span class="vlist-t vlist-t2"
												><span class="vlist-r"
													><span class="vlist" style="height: 0.311664em"
														><span
															style="
																top: -2.5500000000000003em;
																margin-left: 0em;
																margin-right: 0.05em;
															"
															><span class="pstrut" style="height: 2.7em"></span
															><span class="sizing reset-size6 size3 mtight"
																><span class="mord mtight"
																	><span class="mord mathnormal mtight">i</span
																	><span class="mpunct mtight">,</span
																	><span
																		class="mord mathnormal mtight"
																		style="margin-right: 0.05724em"
																		>j</span
																	></span
																></span
															></span
														></span
													><span class="vlist-s">​</span></span
												><span class="vlist-r"
													><span class="vlist" style="height: 0.286108em"
														><span></span></span></span></span></span></span
									><span
										class="mspace"
										style="margin-right: 0.2777777777777778em"
									></span
									><span class="mrel">=</span
									><span
										class="mspace"
										style="margin-right: 0.2777777777777778em"
									></span></span
								><span class="base"
									><span
										class="strut"
										style="
											height: 3.0000299999999998em;
											vertical-align: -1.25003em;
										"
									></span
									><span class="minner"
										><span class="mopen delimcenter" style="top: 0em"
											><span class="delimsizing size4">{</span></span
										><span class="mord"
											><span class="mtable"
												><span class="col-align-l"
													><span class="vlist-t vlist-t2"
														><span class="vlist-r"
															><span class="vlist" style="height: 1.69em"
																><span style="top: -3.69em"
																	><span
																		class="pstrut"
																		style="height: 3.008em"
																	></span
																	><span class="mord"
																		><span class="mord">0</span></span
																	></span
																><span style="top: -2.25em"
																	><span
																		class="pstrut"
																		style="height: 3.008em"
																	></span
																	><span class="mord"
																		><span class="mord">1</span></span
																	></span
																></span
															><span class="vlist-s">​</span></span
														><span class="vlist-r"
															><span class="vlist" style="height: 1.19em"
																><span></span></span></span></span></span
												><span class="arraycolsep" style="width: 1em"></span
												><span class="col-align-l"
													><span class="vlist-t vlist-t2"
														><span class="vlist-r"
															><span class="vlist" style="height: 1.69em"
																><span style="top: -3.69em"
																	><span
																		class="pstrut"
																		style="height: 3.008em"
																	></span
																	><span class="mord"
																		><span class="mord text"
																			><span class="mord">white</span></span
																		></span
																	></span
																><span style="top: -2.25em"
																	><span
																		class="pstrut"
																		style="height: 3.008em"
																	></span
																	><span class="mord"
																		><span class="mord text"
																			><span class="mord">black</span></span
																		></span
																	></span
																></span
															><span class="vlist-s">​</span></span
														><span class="vlist-r"
															><span class="vlist" style="height: 1.19em"
																><span></span></span></span></span></span></span></span
										><span class="mclose nulldelimiter"></span></span
									><span
										class="mspace"
										style="margin-right: 0.16666666666666666em"
									></span
									><span class="mord">.</span></span
								></span
							></span
						></span
					>
				</p>
				<p>
					Find the side length
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow><mi>Z</mi></mrow
									><annotation encoding="application/x-tex"
										>Z</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.68333em; vertical-align: 0em"
								></span
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>Z</span
								></span
							></span
						></span
					>
					of the largest square of cells, such that all the cells on the
					boundary of the square are black.
				</p>
			</blockquote>
			<p>
				Select solutions are presented below in decreasing order of runtime
				complexity. Any additional improvements are welcome.
			</p>
			<h2 id="on3">
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>3</mn></msup
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^3)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">3</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span class="mclose">)</span></span
						></span
					></span
				>
			</h2>
			<p>
				Let
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>U</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>U_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>U</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.10903em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				store the largest length of consecutive black cells, starting from cell
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				and moving upwards. Similarly, define
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>R</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									><mo separator="true">,</mo
									><msub
										><mi>D</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									><mo separator="true">,</mo
									><msub
										><mi>L</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>R_{i,j},D_{i,j},L_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.00773em"
									>R</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.00773em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.02778em"
									>D</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.02778em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord"
								><span class="mord mathnormal">L</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: 0em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>. One can then iterate over all possible upper-left corners of squares
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>, and for each possible square size
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>, check that we have the required lengths of consecutive black cells on
				each edge:
			</p>
			<pre><code><code><div>Z = 0
for i in [0, N]:
	for j in [0, N]:
		for k in [1, N]:
			# Range check.
			if i + k - 1 &gt;= N or j + k - 1 &gt;= N:
				continue
			# Top &amp; left edges must be fully black.
			if R[i][j] &gt;= k and D[i][j] &gt;= k
				# Bottom &amp; right edges must be fully black.
				and U[i + k][j + k] &gt;= k
				and L[i + k][j + k] &gt;= k:
				Z = max(Z, k)
</div></code></code></pre>
			<p>
				What remains is to compute
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>U</mi><mo separator="true">,</mo><mi>R</mi
									><mo separator="true">,</mo><mi>D</mi
									><mo separator="true">,</mo><mi>L</mi></mrow
								><annotation encoding="application/x-tex"
									>U,R,D,L</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.8777699999999999em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>U</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.00773em"
								>R</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>D</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal">L</span></span
						></span
					></span
				>. We demonstrate the computation for
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>U</mi></mrow
								><annotation encoding="application/x-tex"
									>U</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.68333em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>U</span
							></span
						></span
					></span
				>; the other three matrices are computed similarly. Then, we have the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(1)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span><span class="mord">1</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				recurrence
			</p>
			<p class="katex-block">
				<span class="katex-display"
					><span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"
								><semantics
									><mrow
										><msub
											><mi>U</mi
											><mrow
												><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
											></msub
										><mo>=</mo
										><mrow
											><mo fence="true">{</mo
											><mtable
												rowspacing="0.3600em"
												columnalign="left left"
												columnspacing="1em"
												><mtr
													><mtd
														><mstyle scriptlevel="0" displaystyle="false"
															><msub
																><mi>G</mi
																><mrow
																	><mi>i</mi><mo separator="true">,</mo
																	><mi>j</mi></mrow
																></msub
															></mstyle
														></mtd
													><mtd
														><mstyle scriptlevel="0" displaystyle="false"
															><mrow
																><mi>i</mi><mo>=</mo><mn>0</mn></mrow
															></mstyle
														></mtd
													></mtr
												><mtr
													><mtd
														><mstyle scriptlevel="0" displaystyle="false"
															><mn>0</mn></mstyle
														></mtd
													><mtd
														><mstyle scriptlevel="0" displaystyle="false"
															><mrow
																><msub
																	><mi>G</mi
																	><mrow
																		><mi>i</mi><mo separator="true">,</mo
																		><mi>j</mi></mrow
																	></msub
																><mo>=</mo><mn>0</mn></mrow
															></mstyle
														></mtd
													></mtr
												><mtr
													><mtd
														><mstyle scriptlevel="0" displaystyle="false"
															><mrow
																><msub
																	><mi>U</mi
																	><mrow
																		><mi>i</mi><mo>−</mo><mn>1</mn
																		><mo separator="true">,</mo><mi>j</mi></mrow
																	></msub
																><mo>+</mo><mn>1</mn></mrow
															></mstyle
														></mtd
													><mtd
														><mstyle scriptlevel="0" displaystyle="false"
															><mrow
																><msub
																	><mi>G</mi
																	><mrow
																		><mi>i</mi><mo separator="true">,</mo
																		><mi>j</mi></mrow
																	></msub
																><mo>=</mo><mn>1</mn></mrow
															></mstyle
														></mtd
													></mtr
												></mtable
											></mrow
										></mrow
									><annotation encoding="application/x-tex"
										>U_{i,j}=\begin{cases} G_{i,j}&amp;i=0\\ 0&amp;G_{i,j}=0\\
										U_{i-1,j}+1&amp;G_{i,j}=1 \end{cases}</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.969438em; vertical-align: -0.286108em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.10903em"
										>U</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span class="vlist" style="height: 0.311664em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.10903em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">i</span
																><span class="mpunct mtight">,</span
																><span
																	class="mord mathnormal mtight"
																	style="margin-right: 0.05724em"
																	>j</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span
								><span
									class="mspace"
									style="margin-right: 0.2777777777777778em"
								></span
								><span class="mrel">=</span
								><span
									class="mspace"
									style="margin-right: 0.2777777777777778em"
								></span></span
							><span class="base"
								><span
									class="strut"
									style="height: 4.32em; vertical-align: -1.9099999999999997em"
								></span
								><span class="minner"
									><span class="mopen"
										><span class="delimsizing mult"
											><span class="vlist-t vlist-t2"
												><span class="vlist-r"
													><span
														class="vlist"
														style="height: 2.3500199999999998em"
														><span style="top: -2.19999em"
															><span
																class="pstrut"
																style="height: 3.15em"
															></span
															><span class="delimsizinginner delim-size4"
																><span>⎩</span></span
															></span
														><span style="top: -2.19199em"
															><span
																class="pstrut"
																style="height: 3.15em"
															></span
															><span
																style="
																	height: 0.31599999999999984em;
																	width: 0.889em;
																"
																><svg
																	width="0.889em"
																	height="0.31599999999999984em"
																	style="width: 0.889em"
																	viewBox="0 0 889 316"
																	preserveAspectRatio="xMinYMin"
																>
																	<path
																		d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"
																	/></svg></span></span
														><span style="top: -3.15001em"
															><span
																class="pstrut"
																style="height: 3.15em"
															></span
															><span class="delimsizinginner delim-size4"
																><span>⎨</span></span
															></span
														><span style="top: -4.292009999999999em"
															><span
																class="pstrut"
																style="height: 3.15em"
															></span
															><span
																style="
																	height: 0.31599999999999984em;
																	width: 0.889em;
																"
																><svg
																	width="0.889em"
																	height="0.31599999999999984em"
																	style="width: 0.889em"
																	viewBox="0 0 889 316"
																	preserveAspectRatio="xMinYMin"
																>
																	<path
																		d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"
																	/></svg></span></span
														><span style="top: -4.600019999999999em"
															><span
																class="pstrut"
																style="height: 3.15em"
															></span
															><span class="delimsizinginner delim-size4"
																><span>⎧</span></span
															></span
														></span
													><span class="vlist-s">​</span></span
												><span class="vlist-r"
													><span
														class="vlist"
														style="height: 1.8500199999999998em"
														><span></span></span></span></span></span></span
									><span class="mord"
										><span class="mtable"
											><span class="col-align-l"
												><span class="vlist-t vlist-t2"
													><span class="vlist-r"
														><span class="vlist" style="height: 2.41em"
															><span style="top: -4.41em"
																><span
																	class="pstrut"
																	style="height: 3.008em"
																></span
																><span class="mord"
																	><span class="mord"
																		><span class="mord mathnormal">G</span
																		><span class="msupsub"
																			><span class="vlist-t vlist-t2"
																				><span class="vlist-r"
																					><span
																						class="vlist"
																						style="height: 0.311664em"
																						><span
																							style="
																								top: -2.5500000000000003em;
																								margin-left: 0em;
																								margin-right: 0.05em;
																							"
																							><span
																								class="pstrut"
																								style="height: 2.7em"
																							></span
																							><span
																								class="
																									sizing
																									reset-size6
																									size3
																									mtight
																								"
																								><span class="mord mtight"
																									><span
																										class="
																											mord
																											mathnormal
																											mtight
																										"
																										>i</span
																									><span class="mpunct mtight"
																										>,</span
																									><span
																										class="
																											mord
																											mathnormal
																											mtight
																										"
																										style="
																											margin-right: 0.05724em;
																										"
																										>j</span
																									></span
																								></span
																							></span
																						></span
																					><span class="vlist-s">​</span></span
																				><span class="vlist-r"
																					><span
																						class="vlist"
																						style="height: 0.286108em"
																						><span></span></span></span></span></span></span></span></span
															><span style="top: -2.97em"
																><span
																	class="pstrut"
																	style="height: 3.008em"
																></span
																><span class="mord"
																	><span class="mord">0</span></span
																></span
															><span style="top: -1.5300000000000002em"
																><span
																	class="pstrut"
																	style="height: 3.008em"
																></span
																><span class="mord"
																	><span class="mord"
																		><span
																			class="mord mathnormal"
																			style="margin-right: 0.10903em"
																			>U</span
																		><span class="msupsub"
																			><span class="vlist-t vlist-t2"
																				><span class="vlist-r"
																					><span
																						class="vlist"
																						style="height: 0.311664em"
																						><span
																							style="
																								top: -2.5500000000000003em;
																								margin-left: -0.10903em;
																								margin-right: 0.05em;
																							"
																							><span
																								class="pstrut"
																								style="height: 2.7em"
																							></span
																							><span
																								class="
																									sizing
																									reset-size6
																									size3
																									mtight
																								"
																								><span class="mord mtight"
																									><span
																										class="
																											mord
																											mathnormal
																											mtight
																										"
																										>i</span
																									><span class="mbin mtight"
																										>−</span
																									><span class="mord mtight"
																										>1</span
																									><span class="mpunct mtight"
																										>,</span
																									><span
																										class="
																											mord
																											mathnormal
																											mtight
																										"
																										style="
																											margin-right: 0.05724em;
																										"
																										>j</span
																									></span
																								></span
																							></span
																						></span
																					><span class="vlist-s">​</span></span
																				><span class="vlist-r"
																					><span
																						class="vlist"
																						style="height: 0.286108em"
																						><span></span></span></span></span></span></span
																	><span
																		class="mspace"
																		style="margin-right: 0.2222222222222222em"
																	></span
																	><span class="mbin">+</span
																	><span
																		class="mspace"
																		style="margin-right: 0.2222222222222222em"
																	></span
																	><span class="mord">1</span></span
																></span
															></span
														><span class="vlist-s">​</span></span
													><span class="vlist-r"
														><span
															class="vlist"
															style="height: 1.9099999999999997em"
															><span></span></span></span></span></span
											><span class="arraycolsep" style="width: 1em"></span
											><span class="col-align-l"
												><span class="vlist-t vlist-t2"
													><span class="vlist-r"
														><span class="vlist" style="height: 2.41em"
															><span style="top: -4.41em"
																><span
																	class="pstrut"
																	style="height: 3.008em"
																></span
																><span class="mord"
																	><span class="mord mathnormal">i</span
																	><span
																		class="mspace"
																		style="margin-right: 0.2777777777777778em"
																	></span
																	><span class="mrel">=</span
																	><span
																		class="mspace"
																		style="margin-right: 0.2777777777777778em"
																	></span
																	><span class="mord">0</span></span
																></span
															><span style="top: -2.97em"
																><span
																	class="pstrut"
																	style="height: 3.008em"
																></span
																><span class="mord"
																	><span class="mord"
																		><span class="mord mathnormal">G</span
																		><span class="msupsub"
																			><span class="vlist-t vlist-t2"
																				><span class="vlist-r"
																					><span
																						class="vlist"
																						style="height: 0.311664em"
																						><span
																							style="
																								top: -2.5500000000000003em;
																								margin-left: 0em;
																								margin-right: 0.05em;
																							"
																							><span
																								class="pstrut"
																								style="height: 2.7em"
																							></span
																							><span
																								class="
																									sizing
																									reset-size6
																									size3
																									mtight
																								"
																								><span class="mord mtight"
																									><span
																										class="
																											mord
																											mathnormal
																											mtight
																										"
																										>i</span
																									><span class="mpunct mtight"
																										>,</span
																									><span
																										class="
																											mord
																											mathnormal
																											mtight
																										"
																										style="
																											margin-right: 0.05724em;
																										"
																										>j</span
																									></span
																								></span
																							></span
																						></span
																					><span class="vlist-s">​</span></span
																				><span class="vlist-r"
																					><span
																						class="vlist"
																						style="height: 0.286108em"
																						><span></span></span></span></span></span></span
																	><span
																		class="mspace"
																		style="margin-right: 0.2777777777777778em"
																	></span
																	><span class="mrel">=</span
																	><span
																		class="mspace"
																		style="margin-right: 0.2777777777777778em"
																	></span
																	><span class="mord">0</span></span
																></span
															><span style="top: -1.5300000000000002em"
																><span
																	class="pstrut"
																	style="height: 3.008em"
																></span
																><span class="mord"
																	><span class="mord"
																		><span class="mord mathnormal">G</span
																		><span class="msupsub"
																			><span class="vlist-t vlist-t2"
																				><span class="vlist-r"
																					><span
																						class="vlist"
																						style="height: 0.311664em"
																						><span
																							style="
																								top: -2.5500000000000003em;
																								margin-left: 0em;
																								margin-right: 0.05em;
																							"
																							><span
																								class="pstrut"
																								style="height: 2.7em"
																							></span
																							><span
																								class="
																									sizing
																									reset-size6
																									size3
																									mtight
																								"
																								><span class="mord mtight"
																									><span
																										class="
																											mord
																											mathnormal
																											mtight
																										"
																										>i</span
																									><span class="mpunct mtight"
																										>,</span
																									><span
																										class="
																											mord
																											mathnormal
																											mtight
																										"
																										style="
																											margin-right: 0.05724em;
																										"
																										>j</span
																									></span
																								></span
																							></span
																						></span
																					><span class="vlist-s">​</span></span
																				><span class="vlist-r"
																					><span
																						class="vlist"
																						style="height: 0.286108em"
																						><span></span></span></span></span></span></span
																	><span
																		class="mspace"
																		style="margin-right: 0.2777777777777778em"
																	></span
																	><span class="mrel">=</span
																	><span
																		class="mspace"
																		style="margin-right: 0.2777777777777778em"
																	></span
																	><span class="mord">1</span></span
																></span
															></span
														><span class="vlist-s">​</span></span
													><span class="vlist-r"
														><span
															class="vlist"
															style="height: 1.9099999999999997em"
															><span></span></span></span></span></span></span></span
									><span
										class="mclose nulldelimiter"
									></span></span></span></span></span
				></span>
			</p>
			<p>
				which can be evaluated over all
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>U</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>U_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>U</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.10903em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				in
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span class="mclose">)</span></span
						></span
					></span
				>.
			</p>
			<h2 id="on2ln-n">
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mi>ln</mi><mo>⁡</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2\ln N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mop">ln</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
			</h2>
			<p>Recall the innermost loop:</p>
			<pre><code><code><div>for k in [1, N]:
	# Range check.
	if i + k - 1 &gt;= N or j + k - 1 &gt;= N:
		continue
	# Top &amp; left edges must be fully black.
	if R[i][j] &gt;= k and D[i][j] &gt;= k
		# Bottom &amp; right edges must be fully black.
		and U[i + k][j + k] &gt;= k
		and L[i + k][j + k] &gt;= k:
		Z = max(Z, k)
</div></code></code></pre>
			<p>
				The purpose of this loop is to find the size of the largest valid square
				with top-left corner at
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>. We know before even entering the loop that there is some
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo
									><msub
										><mi>R</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									><mo separator="true">,</mo
									><msub
										><mi>D</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>K_{i,j}=\min(R_{i,j},D_{i,j})</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">=</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 1.036108em; vertical-align: -0.286108em"
							></span
							><span class="mop">min</span><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.00773em"
									>R</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.00773em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.02778em"
									>D</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.02778em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mclose">)</span></span
						></span
					></span
				>
				that upper-bounds the size. It remains to iterate through all
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>k</mi><mo>≤</mo
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>k\leq K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83041em; vertical-align: -0.13597em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≤</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				and check the bottom-right corner for
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo
									><msub
										><mi>U</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									><mo separator="true">,</mo
									><msub
										><mi>L</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>\min(U_{i,j},L_{i,j})</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.036108em; vertical-align: -0.286108em"
							></span
							><span class="mop">min</span><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>U</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.10903em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord"
								><span class="mord mathnormal">L</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: 0em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mclose">)</span></span
						></span
					></span
				>.
			</p>
			<p>
				For all given
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				on a upper-left-to-lower-right diagonal, all candidate bottom-right
				corners lie on the same diagonal. Thus, it is likely we are performing
				unnecessary work in (re-)checking these bottom-right corners
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
									><mi>j</mi><mo>+</mo><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>i+k,j+k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord mathnormal">i</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">+</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.8888799999999999em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">+</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>. To resolve this, we batch process the entire diagonal together.
			</p>
			<p>
				Observe that the larger
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>
				is, the larger
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo
									><msub
										><mi>U</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									><mo separator="true">,</mo
									><msub
										><mi>L</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>\min(U_{i+k,j+k},L_{i+k,j+k})</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.036108em; vertical-align: -0.286108em"
							></span
							><span class="mop">min</span><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>U</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.10903em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord"
								><span class="mord mathnormal">L</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: 0em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mclose">)</span></span
						></span
					></span
				>
				will need to be. In fact, it always needs to be at least
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>
				to be considered a valid candidate for bottom-right corner for the
				upper-left corner
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>. Instead of testing each
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo
									><msub
										><mi>U</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									><mo separator="true">,</mo
									><msub
										><mi>L</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>\min(U_{i+k,j+k},L_{i+k,j+k})</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.036108em; vertical-align: -0.286108em"
							></span
							><span class="mop">min</span><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>U</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.10903em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord"
								><span class="mord mathnormal">L</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: 0em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span class="mclose">)</span></span
						></span
					></span
				>
				against a different
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>, we can instead discount each by
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>, and test against
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mn>0</mn></mrow
								><annotation encoding="application/x-tex"
									>0</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.64444em; vertical-align: 0em"
							></span
							><span class="mord">0</span></span
						></span
					></span
				>.
			</p>
			<p>
				Let
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>X</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>X_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07847em"
									>X</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07847em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				be this discounted minimum, pre-computed in
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span class="mclose">)</span></span
						></span
					></span
				>:
			</p>
			<p class="katex-block">
				<span class="katex-display"
					><span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"
								><semantics
									><mrow
										><msub
											><mi>X</mi
											><mrow
												><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
											></msub
										><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo
										><msub
											><mi>U</mi
											><mrow
												><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
											></msub
										><mo separator="true">,</mo
										><msub
											><mi>L</mi
											><mrow
												><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
											></msub
										><mo stretchy="false">)</mo><mo>−</mo><mi>i</mi
										><mi mathvariant="normal">.</mi></mrow
									><annotation encoding="application/x-tex"
										>X_{i,j}=\min(U_{i,j},L_{i,j})-i.
									</annotation></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.969438em; vertical-align: -0.286108em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.07847em"
										>X</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span class="vlist" style="height: 0.311664em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.07847em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">i</span
																><span class="mpunct mtight">,</span
																><span
																	class="mord mathnormal mtight"
																	style="margin-right: 0.05724em"
																	>j</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span
								><span
									class="mspace"
									style="margin-right: 0.2777777777777778em"
								></span
								><span class="mrel">=</span
								><span
									class="mspace"
									style="margin-right: 0.2777777777777778em"
								></span></span
							><span class="base"
								><span
									class="strut"
									style="height: 1.036108em; vertical-align: -0.286108em"
								></span
								><span class="mop">min</span><span class="mopen">(</span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.10903em"
										>U</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span class="vlist" style="height: 0.311664em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.10903em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">i</span
																><span class="mpunct mtight">,</span
																><span
																	class="mord mathnormal mtight"
																	style="margin-right: 0.05724em"
																	>j</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span
								><span class="mpunct">,</span
								><span
									class="mspace"
									style="margin-right: 0.16666666666666666em"
								></span
								><span class="mord"
									><span class="mord mathnormal">L</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span class="vlist" style="height: 0.311664em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: 0em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">i</span
																><span class="mpunct mtight">,</span
																><span
																	class="mord mathnormal mtight"
																	style="margin-right: 0.05724em"
																	>j</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span
								><span class="mclose">)</span
								><span
									class="mspace"
									style="margin-right: 0.2222222222222222em"
								></span
								><span class="mbin">−</span
								><span
									class="mspace"
									style="margin-right: 0.2222222222222222em"
								></span></span
							><span class="base"
								><span
									class="strut"
									style="height: 0.65952em; vertical-align: 0em"
								></span
								><span class="mord mathnormal">i</span
								><span class="mord">.</span></span
							></span
						></span
					></span
				>
			</p>
			<p>
				The discount
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>-i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>
				should be different for every
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				upper-left corner considered on the same diagonal: if an upper-left
				corner has larger
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.65952em; vertical-align: 0em"
							></span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>, its candidate bottom-right corners should be discounted less. Now, we
				have the nice property that if
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>X</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									><mo>≥</mo><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>X_{i+k,j+k}\geq -i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07847em"
									>X</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07847em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≥</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>, then
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
									><mi>j</mi><mo>+</mo><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>i+k,j+k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord mathnormal">i</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">+</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.8888799999999999em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">+</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>
				is a valid bottom-right corner for the upper-left corner
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>.
			</p>
			<p>
				We can double-check our logic by considering black cells
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>, for which we have
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>X</mi
										><mrow
											><mi>i</mi><mo>+</mo><mn>0</mn><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mn>0</mn></mrow
										></msub
									><mo>≥</mo><mn>1</mn><mo>−</mo><mi>i</mi><mo>≥</mo><mo>−</mo
									><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>X_{i+0,j+0}\geq 1-i\geq -i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07847em"
									>X</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07847em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span class="mord mtight">0</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span class="mord mtight">0</span></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≥</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.72777em; vertical-align: -0.08333em"
							></span
							><span class="mord">1</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">−</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.79549em; vertical-align: -0.13597em"
							></span
							><span class="mord mathnormal">i</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≥</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>: thus, all black cells form a valid square of size
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mn>1</mn></mrow
								><annotation encoding="application/x-tex"
									>1</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.64444em; vertical-align: 0em"
							></span
							><span class="mord">1</span></span
						></span
					></span
				>
				by themselves.
			</p>
			<p>
				Given a set of the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>X</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>X_{i+k,j+k}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07847em"
									>X</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07847em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				on a diagonal, for each upper-left corner
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				on the diagonal, we simply take the max
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>,
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>k</mi><mo>≤</mo
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>k\leq K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83041em; vertical-align: -0.13597em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≤</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				in the set where
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>X</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									><mo>≥</mo><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>X_{i+k,j+k}\geq -i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07847em"
									>X</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07847em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≥</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>. This
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>
				denotes the largest valid square with
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				as its upper-left corner. We can optimize this search a little by first
				sorting incrementally the list of
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>X</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>X_{i+k,j+k}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07847em"
									>X</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07847em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				on each diagonal. Let this sorted list be
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>S</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>S_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				for the diagonal
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>d</mi></mrow
								><annotation encoding="application/x-tex"
									>d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal">d</span></span
						></span
					></span
				>
				containing
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>, and let
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>Y</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>Y_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				be the list of $k$s which produced
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>S</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>S_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span></span
				>. Then, the set of
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>X</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									><mo>≥</mo><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>X_{i+k,j+k}\geq -i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07847em"
									>X</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07847em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≥</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>
				can simply be found as a postfix after binary searching on
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>-i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>. Sorting each set on each diagonal is
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mi>ln</mi><mo>⁡</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2\ln N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mop">ln</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>, so it remains to consider the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>k</mi><mo>≤</mo
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>k\leq K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83041em; vertical-align: -0.13597em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≤</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				bound.
			</p>
			<p>
				For each diagonal, we can maintain a segment tree
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>T</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>T_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.13889em"
									>T</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.13889em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				aligned with
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>S</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>S_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				and
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>Y</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>Y_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span></span
				>. Initially, prior to processing each diagonal, the tree’s values are
				set to
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mo>−</mo><mi>N</mi></mrow
								><annotation encoding="application/x-tex"
									>-N</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.76666em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							></span
						></span
					></span
				>. As we process upper-left corners
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>, we will continuously update the tree’s indices to reflect
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>Y</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>Y_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span></span
				>. Each query we perform on the tree will be querying the max over a
				postfix.
			</p>
			<p>
				To account for the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>k</mi><mn>0</mn></msub></mrow
								><annotation encoding="application/x-tex"
									>k_0</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.84444em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.03148em"
									>k</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.30110799999999993em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.03148em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">0</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				bound, we ensure that at the time of processing
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>,
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>T</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>T_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.13889em"
									>T</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.13889em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				contains only the elements in
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>S</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>S_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				which result from a
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>k</mi><mo>≤</mo
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>k\leq K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83041em; vertical-align: -0.13597em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≤</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>. Naturally, then, along each diagonal, we must process the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				in increasing sorted order of
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>. Prior to processing each
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>, we update
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>T</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>T_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.13889em"
									>T</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.13889em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				such that it reflects
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>Y</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>Y_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				everywhere
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>Y</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>Y_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				is at most
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>. Then, binary searching on
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>S</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>S_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				for index
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>e</mi><mn>0</mn></msub></mrow
								><annotation encoding="application/x-tex"
									>e_0</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.58056em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal">e</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.30110799999999993em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: 0em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">0</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				such that all
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>S</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									><mo>≥</mo><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>S_{d,e}\geq -i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≥</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>
				for
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>e</mi><mo>≥</mo><msub><mi>e</mi><mn>0</mn></msub></mrow
								><annotation encoding="application/x-tex"
									>e\geq e_0</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.7719400000000001em; vertical-align: -0.13597em"
							></span
							><span class="mord mathnormal">e</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≥</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.58056em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal">e</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.30110799999999993em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: 0em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">0</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				gives us the postfix, and querying
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>T</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>T_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.13889em"
									>T</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.13889em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				on this postfix gives the maximum element in
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>Y</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>Y_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				on this postfix which is also no greater than
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>, as desired.
			</p>
			<p>
				Finally, recall that segment tree range queries and point updates are
				both
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>ln</mi><mo>⁡</mo
									><mi>N</mi><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(\ln N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span><span class="mop">ln</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>. Across a diagonal,
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				queries and updates are made to
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>T</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>T_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.13889em"
									>T</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.13889em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span></span
				>. Over
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				diagonals, then, the cost of the segment trees is
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mi>ln</mi><mo>⁡</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2\ln N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mop">ln</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				as desired.
			</p>
			<h2 id="on2alphan-for-inverse-ackermann-function-alpha">
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mi>α</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2\alpha(N))</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span class="mord mathnormal" style="margin-right: 0.0037em"
								>α</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">))</span></span
						></span
					></span
				>
				(for inverse-Ackermann function
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>α</mi></mrow
								><annotation encoding="application/x-tex"
									>\alpha</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.43056em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.0037em"
								>α</span
							></span
						></span
					></span
				>)
			</h2>
			<p>
				Additional work can be optimized from the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mi>ln</mi><mo>⁡</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2\ln N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mop">ln</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				approach by reconsidering the necessary sorts and segment trees in
				thresholding
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>X</mi
										><mrow
											><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
											><mi>j</mi><mo>+</mo><mi>k</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>X_{i+k,j+k}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07847em"
									>X</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07847em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															><span class="mbin mtight">+</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.03148em"
																>k</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				as desired. Recall the subproblem as follows:
			</p>
			<blockquote>
				<p>
					On each diagonal
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow><mi>d</mi></mrow
									><annotation encoding="application/x-tex"
										>d</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.69444em; vertical-align: 0em"
								></span
								><span class="mord mathnormal">d</span></span
							></span
						></span
					>, for each upper-left corner
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
									><annotation encoding="application/x-tex"
										>i,j</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.85396em; vertical-align: -0.19444em"
								></span
								><span class="mord mathnormal">i</span
								><span class="mpunct">,</span
								><span
									class="mspace"
									style="margin-right: 0.16666666666666666em"
								></span
								><span class="mord mathnormal" style="margin-right: 0.05724em"
									>j</span
								></span
							></span
						></span
					>, we must find in the set
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow
										><msub
											><mi>X</mi
											><mrow
												><mi>i</mi><mo>+</mo><mi>k</mi
												><mo separator="true">,</mo><mi>j</mi><mo>+</mo
												><mi>k</mi></mrow
											></msub
										></mrow
									><annotation encoding="application/x-tex"
										>X_{i+k,j+k}</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.969438em; vertical-align: -0.286108em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.07847em"
										>X</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span
													class="vlist"
													style="height: 0.3361079999999999em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.07847em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">i</span
																><span class="mbin mtight">+</span
																><span
																	class="mord mathnormal mtight"
																	style="margin-right: 0.03148em"
																	>k</span
																><span class="mpunct mtight">,</span
																><span
																	class="mord mathnormal mtight"
																	style="margin-right: 0.05724em"
																	>j</span
																><span class="mbin mtight">+</span
																><span
																	class="mord mathnormal mtight"
																	style="margin-right: 0.03148em"
																	>k</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span></span></span
					></span>
					of candidate bottom-right corners and derivative diangonal-wise lists
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow
										><msub><mi>S</mi><mi>d</mi></msub></mrow
									><annotation encoding="application/x-tex"
										>S_d</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.83333em; vertical-align: -0.15em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.05764em"
										>S</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span
													class="vlist"
													style="height: 0.33610799999999996em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.05764em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mathnormal mtight"
																>d</span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.15em"
													><span></span></span></span></span></span></span></span></span></span
					>,
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow
										><msub><mi>Y</mi><mi>d</mi></msub></mrow
									><annotation encoding="application/x-tex"
										>Y_d</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.83333em; vertical-align: -0.15em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.22222em"
										>Y</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span
													class="vlist"
													style="height: 0.33610799999999996em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.22222em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mathnormal mtight"
																>d</span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.15em"
													><span></span></span></span></span></span></span></span></span
					></span>
					the index
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow><mi>e</mi></mrow
									><annotation encoding="application/x-tex"
										>e</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.43056em; vertical-align: 0em"
								></span
								><span class="mord mathnormal">e</span></span
							></span
						></span
					>
					with maximum
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow
										><msub
											><mi>Y</mi
											><mrow
												><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
											></msub
										></mrow
									><annotation encoding="application/x-tex"
										>Y_{d,e}</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.969438em; vertical-align: -0.286108em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.22222em"
										>Y</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span
													class="vlist"
													style="height: 0.3361079999999999em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.22222em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">d</span
																><span class="mpunct mtight">,</span
																><span class="mord mathnormal mtight"
																	>e</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span></span></span
					></span>
					where
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow
										><msub
											><mi>S</mi
											><mrow
												><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
											></msub
										><mo>≥</mo><mo>−</mo><mi>i</mi></mrow
									><annotation encoding="application/x-tex"
										>S_{d,e}\geq -i</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.969438em; vertical-align: -0.286108em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.05764em"
										>S</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span
													class="vlist"
													style="height: 0.3361079999999999em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.05764em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">d</span
																><span class="mpunct mtight">,</span
																><span class="mord mathnormal mtight"
																	>e</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span
								><span
									class="mspace"
									style="margin-right: 0.2777777777777778em"
								></span
								><span class="mrel">≥</span
								><span
									class="mspace"
									style="margin-right: 0.2777777777777778em"
								></span></span
							><span class="base"
								><span
									class="strut"
									style="height: 0.74285em; vertical-align: -0.08333em"
								></span
								><span class="mord">−</span
								><span class="mord mathnormal">i</span></span
							></span
						></span
					>
					and
					<span class="katex"
						><span class="katex-mathml"
							><math xmlns="http://www.w3.org/1998/Math/MathML"
								><semantics
									><mrow
										><msub
											><mi>Y</mi
											><mrow
												><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
											></msub
										><mo>≤</mo
										><msub
											><mi>K</mi
											><mrow
												><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
											></msub
										></mrow
									><annotation encoding="application/x-tex"
										>Y_{d,e}\leq K_{i,j}</annotation
									></semantics
								></math
							></span
						><span class="katex-html" aria-hidden="true"
							><span class="base"
								><span
									class="strut"
									style="height: 0.969438em; vertical-align: -0.286108em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.22222em"
										>Y</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span
													class="vlist"
													style="height: 0.3361079999999999em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.22222em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">d</span
																><span class="mpunct mtight">,</span
																><span class="mord mathnormal mtight"
																	>e</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span
								><span
									class="mspace"
									style="margin-right: 0.2777777777777778em"
								></span
								><span class="mrel">≤</span
								><span
									class="mspace"
									style="margin-right: 0.2777777777777778em"
								></span></span
							><span class="base"
								><span
									class="strut"
									style="height: 0.969438em; vertical-align: -0.286108em"
								></span
								><span class="mord"
									><span class="mord mathnormal" style="margin-right: 0.07153em"
										>K</span
									><span class="msupsub"
										><span class="vlist-t vlist-t2"
											><span class="vlist-r"
												><span class="vlist" style="height: 0.311664em"
													><span
														style="
															top: -2.5500000000000003em;
															margin-left: -0.07153em;
															margin-right: 0.05em;
														"
														><span class="pstrut" style="height: 2.7em"></span
														><span class="sizing reset-size6 size3 mtight"
															><span class="mord mtight"
																><span class="mord mathnormal mtight">i</span
																><span class="mpunct mtight">,</span
																><span
																	class="mord mathnormal mtight"
																	style="margin-right: 0.05724em"
																	>j</span
																></span
															></span
														></span
													></span
												><span class="vlist-s">​</span></span
											><span class="vlist-r"
												><span class="vlist" style="height: 0.286108em"
													><span></span></span></span></span></span></span></span></span></span
					>.
				</p>
			</blockquote>
			<p>
				Of course, we will no longer be able to sort
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>S</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>S_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				for this approach. For this approach, assume that
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>S</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>S_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				and likewise
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub><mi>Y</mi><mi>d</mi></msub></mrow
								><annotation encoding="application/x-tex"
									>Y_d</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.83333em; vertical-align: -0.15em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.33610799999999996em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mathnormal mtight">d</span></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.15em"
												><span></span></span></span></span></span></span></span></span
				></span>
				are arranged in order from upper-left to bottom-right on the diagonal:
				that is,
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>S</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mn>0</mn></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>S_{d,0}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mtight">0</span></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				corresponds to the upper-most square on the diagonal. We perform an
				implicit sort by iterating through
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>e</mi></mrow
								><annotation encoding="application/x-tex"
									>e</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.43056em; vertical-align: 0em"
							></span
							><span class="mord mathnormal">e</span></span
						></span
					></span
				>
				along the diagonal: upon considering a new
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>e</mi></mrow
								><annotation encoding="application/x-tex"
									>e</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.43056em; vertical-align: 0em"
							></span
							><span class="mord mathnormal">e</span></span
						></span
					></span
				>
				corresponding to
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>, we place a <em>marker</em> on index
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>e</mi><mo>+</mo
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>e+K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.66666em; vertical-align: -0.08333em"
							></span
							><span class="mord mathnormal">e</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">+</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>. At the time of seeing a marker for a previous
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msup
										><mi>e</mi
										><mo mathvariant="normal" lspace="0em" rspace="0em"
											>′</mo
										></msup
									></mrow
								><annotation encoding="application/x-tex"
									>e&#x27;</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.751892em; vertical-align: 0em"
							></span
							><span class="mord"
								><span class="mord mathnormal">e</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.751892em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mtight">′</span></span
														></span
													></span
												></span
											></span
										></span
									></span
								></span
							></span
						></span
					></span
				>, we know that all the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				we have previously seen must definitely satisfy
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									><mo>≤</mo
									><msub
										><mi>K</mi
										><mrow
											><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}\leq K_{i,j}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span
							><span class="mrel">≤</span
							><span
								class="mspace"
								style="margin-right: 0.2777777777777778em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.07153em"
									>K</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.311664em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.07153em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">i</span
															><span class="mpunct mtight">,</span
															><span
																class="mord mathnormal mtight"
																style="margin-right: 0.05724em"
																>j</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>. It remains to satisfy the threshold condition and take a max over the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>. This marker-placing process takes
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span class="mclose">)</span></span
						></span
					></span
				>
				in total, as desired.
			</p>
			<p>
				For a given marker on index
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>e</mi></mrow
								><annotation encoding="application/x-tex"
									>e</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.43056em; vertical-align: 0em"
							></span
							><span class="mord mathnormal">e</span></span
						></span
					></span
				>
				previously placed, let
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>E</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>E_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>E</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				store the pair
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				which originally placed the marker. Recall that this means that the cell
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>e</mi></mrow
								><annotation encoding="application/x-tex"
									>e</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.43056em; vertical-align: 0em"
							></span
							><span class="mord mathnormal">e</span></span
						></span
					></span
				>
				and the cell
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				form a boundary around all candidate squares to consider for the
				upper-left corner
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>, where we already know the top and left edges of each are completely
				black. The expression
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mo>−</mo
									><msub
										><mi>E</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi
											><mo separator="true">,</mo><mn>0</mn></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>-E_{d,e,0}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord">−</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>E</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight">e</span
															><span class="mpunct mtight">,</span
															><span class="mord mtight">0</span></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				then computes the lower-bound for
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>S</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>S_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				which we consider for the max
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>.
			</p>
			<p>
				Across the entire diagonal, the lower-bound thresholds to consider form
				a very complete set, beginning with
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>-i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>
				of the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow
								><annotation encoding="application/x-tex"
									>i,j</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.85396em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal">i</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							></span
						></span
					></span
				>
				of the upper-left cell in the diagonal to
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mo>−</mo><mi>i</mi><mo>−</mo><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>-i-k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span><span class="mord mathnormal">i</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">−</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>
				of
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>i</mi><mo>+</mo><mi>k</mi><mo separator="true">,</mo
									><mi>j</mi><mo>+</mo><mi>k</mi></mrow
								><annotation encoding="application/x-tex"
									>i+k,j+k</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord mathnormal">i</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">+</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.8888799999999999em; vertical-align: -0.19444em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							><span class="mpunct">,</span
							><span
								class="mspace"
								style="margin-right: 0.16666666666666666em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.05724em"
								>j</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span
							><span class="mbin">+</span
							><span
								class="mspace"
								style="margin-right: 0.2222222222222222em"
							></span></span
						><span class="base"
							><span
								class="strut"
								style="height: 0.69444em; vertical-align: 0em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.03148em"
								>k</span
							></span
						></span
					></span
				>
				of the bottom-right cell in the diagonal. Once a threshold
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>-i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>
				is processed with the processing of the marker
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mi>e</mi></mrow
								><annotation encoding="application/x-tex"
									>e</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.43056em; vertical-align: 0em"
							></span
							><span class="mord mathnormal">e</span></span
						></span
					></span
				>
				whose expression
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mo>−</mo
									><msub
										><mi>E</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi
											><mo separator="true">,</mo><mn>0</mn></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>-E_{d,e,0}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord">−</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>E</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight">e</span
															><span class="mpunct mtight">,</span
															><span class="mord mtight">0</span></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				computes
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>-i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>, it will never be encountered again. We can interpret the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>S</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>S_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				as being placed into
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				bins along each diagonal. Thresholding by
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow><mo>−</mo><mi>i</mi></mrow
								><annotation encoding="application/x-tex"
									>-i</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.74285em; vertical-align: -0.08333em"
							></span
							><span class="mord">−</span
							><span class="mord mathnormal">i</span></span
						></span
					></span
				>
				during marker processing simply asks for the max associated
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				along a postfix of the bins at the time of the marker processing.
				Observe that we will never query the same postfix twice. Similarly, each
				bin need only store the maximum
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				whose
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>S</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>S_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.05764em"
									>S</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.05764em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				lands in the bin.
			</p>
			<p>
				We now make <em>skip pointers</em> between the
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				bins, where each skip pointer points to the not-less-negative threshold
				bin with the largest
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				(may be itself). Updating a bin (with a larger
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span></span
				>) will not modify its skip pointer; however, querying a bin for the
				largest
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				amongst its not-less-negative will afterwards set its skip pointer to
				point to the bin which contains the query answer. To perform a query, we
				simply follow the skip pointers until they loop to the same node; that
				means that we have found the largest
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><msub
										><mi>Y</mi
										><mrow
											><mi>d</mi><mo separator="true">,</mo><mi>e</mi></mrow
										></msub
									></mrow
								><annotation encoding="application/x-tex"
									>Y_{d,e}</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 0.969438em; vertical-align: -0.286108em"
							></span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.22222em"
									>Y</span
								><span class="msupsub"
									><span class="vlist-t vlist-t2"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.3361079999999999em"
												><span
													style="
														top: -2.5500000000000003em;
														margin-left: -0.22222em;
														margin-right: 0.05em;
													"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight"
															><span class="mord mathnormal mtight">d</span
															><span class="mpunct mtight">,</span
															><span class="mord mathnormal mtight"
																>e</span
															></span
														></span
													></span
												></span
											><span class="vlist-s">​</span></span
										><span class="vlist-r"
											><span class="vlist" style="height: 0.286108em"
												><span></span></span></span></span></span></span></span></span
				></span>
				amongst this threshold (bin)’s not-less-negative threshold (bin)’s, as
				desired.
			</p>
			<p>
				This <em>skip pointer</em> approach is exactly the ask of the
				union-find/disjoint-set-union data structure (DSU) on
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				nodes. With path compression and union by rank, DSUs average
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>α</mi
									><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(\alpha(N))</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.0037em"
								>α</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">))</span></span
						></span
					></span
				>
				per query and update. Thus, over
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				nodes per
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N)</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">)</span></span
						></span
					></span
				>
				diagonals, this forms the bottleneck of the approach at
				<span class="katex"
					><span class="katex-mathml"
						><math xmlns="http://www.w3.org/1998/Math/MathML"
							><semantics
								><mrow
									><mi>O</mi><mo stretchy="false">(</mo
									><msup><mi>N</mi><mn>2</mn></msup
									><mi>α</mi><mo stretchy="false">(</mo><mi>N</mi
									><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow
								><annotation encoding="application/x-tex"
									>O(N^2\alpha(N))</annotation
								></semantics
							></math
						></span
					><span class="katex-html" aria-hidden="true"
						><span class="base"
							><span
								class="strut"
								style="height: 1.064108em; vertical-align: -0.25em"
							></span
							><span class="mord mathnormal" style="margin-right: 0.02778em"
								>O</span
							><span class="mopen">(</span
							><span class="mord"
								><span class="mord mathnormal" style="margin-right: 0.10903em"
									>N</span
								><span class="msupsub"
									><span class="vlist-t"
										><span class="vlist-r"
											><span class="vlist" style="height: 0.8141079999999999em"
												><span style="top: -3.063em; margin-right: 0.05em"
													><span class="pstrut" style="height: 2.7em"></span
													><span class="sizing reset-size6 size3 mtight"
														><span class="mord mtight">2</span></span
													></span
												></span
											></span
										></span
									></span
								></span
							><span class="mord mathnormal" style="margin-right: 0.0037em"
								>α</span
							><span class="mopen">(</span
							><span class="mord mathnormal" style="margin-right: 0.10903em"
								>N</span
							><span class="mclose">))</span></span
						></span
					></span
				>.
			</p>
		</template>
	</body>
</html>
